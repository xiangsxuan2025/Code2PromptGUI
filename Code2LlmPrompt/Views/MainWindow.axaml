<Window
xmlns="https://github.com/avaloniaui"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:vm="clr-namespace:Code2LlmPrompt.ViewModels"
xmlns:controls="clr-namespace:Code2LlmPrompt.Views.Controls"
x:Class="Code2LlmPrompt.Views.MainWindow"
x:DataType="vm:MainViewModel"
Title="Code2Prompt GUI"
Width="650"
Height="500"
MinWidth="500"
MinHeight="400"
WindowStartupLocation="CenterScreen"
Name="MainWindowControl"
>

	<Window.Styles>
		<StyleInclude Source="avares://Avalonia.Themes.Fluent/FluentTheme.xaml" />
		<StyleInclude Source="avares://Code2LlmPrompt/Styles/GeekTheme.axaml" />
	</Window.Styles>

	<DockPanel>
		<!-- Header - 始终显示，不模糊 -->
		<controls:HeaderControl DockPanel.Dock="Top" />

		<!-- 主内容区域 -->
		<Grid Margin="10">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="Auto" />
			</Grid.ColumnDefinitions>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="*" />
			</Grid.RowDefinitions>

			<!-- Advanced Toggle Button -->
			<Button
			Grid.Column="1"
			Grid.Row="0"
			Content="⚙️ Advanced"
			Command="{Binding ToggleAdvancedCommand}"
			Classes="secondary-btn"
			Margin="0,0,0,8"
			HorizontalAlignment="Right"
			Width="100"
			Height="30"
			/>

			<!-- 左侧配置区域 -->
			<ScrollViewer
			Grid.Column="0"
			Grid.Row="1"
			Margin="0,0,10,0"
			VerticalScrollBarVisibility="Auto">
				<StackPanel Spacing="10" Name="ConfigPanel">
					<controls:BasicSettingsControl />

					<!-- Advanced Controls - Collapsed by default -->
					<StackPanel Spacing="10" IsVisible="{Binding IsAdvancedMode}">
						<controls:FileSelectionControl />
						<controls:OutputFormatControl />
						<controls:GitIntegrationControl />
						<controls:TokenSettingsControl />
					</StackPanel>
				</StackPanel>
			</ScrollViewer>

			<!-- 右侧输出区域 -->
			<Grid Grid.Column="1" Grid.Row="1" RowDefinitions="*,Auto">
				<controls:OutputPanelControl Grid.Row="0" />
			</Grid>

			<!-- 处理时的模糊覆盖层 - 只覆盖主内容区域 -->
			<Border
			Grid.Column="0"
			Grid.ColumnSpan="2"
			Grid.Row="1"
			IsVisible="{Binding IsProcessing}"
			Background="#CC1a1a2e"
			ZIndex="1000">
				<Border.Effect>
					<BlurEffect Radius="8" />
				</Border.Effect>
			</Border>

			<!-- 清晰的进度指示器 -->
			<Border
			Grid.Column="0"
			Grid.ColumnSpan="2"
			Grid.Row="1"
			IsVisible="{Binding IsProcessing}"
			Background="Transparent"
			ZIndex="1001"
			HorizontalAlignment="Center"
			VerticalAlignment="Center">
				<StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="15" Background="#1a1a2e">
					<ProgressBar IsIndeterminate="True" Height="6" Width="300" Classes="progress-bar" />
					<TextBlock
					Text="Processing... Please wait"
					HorizontalAlignment="Center"
					Classes="processing-text"
					FontSize="14"
					/>
				</StackPanel>
			</Border>
		</Grid>
	</DockPanel>
</Window>
